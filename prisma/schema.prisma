// Prisma Schema for Nixtia E-Commerce
// Updated: 2025-11-25 (Story 0.2 - corrected to match actual code usage)

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Products table - stores product catalog
model products {
  id          String   @id @default(uuid())
  name        String
  description String?
  price       Decimal  @db.Decimal(10, 2)
  image_url   String?
  active      Boolean  @default(true)
  created_at  DateTime @default(now())
  updated_at  DateTime @updatedAt
}

// Orders table - stores customer orders
model orders {
  id             String   @id @default(uuid())
  order_number   String   @unique
  customer_phone String
  payment_method String
  payment_status String   @default("PENDING")
  order_status   String   @default("CONFIRMED")
  items_json     Json     // Stores cart items as JSON
  total          Decimal  @db.Decimal(10, 2)
  created_at     DateTime @default(now())
  updated_at     DateTime @updatedAt

  @@index([customer_phone])
  @@index([created_at])
}

// Admin profiles table - linked to Supabase Auth
model profiles {
  id         String   @id @default(uuid())
  email      String   @unique
  role       String   @default("admin")
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
}
